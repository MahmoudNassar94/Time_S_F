{"cells":[{"cell_type":"markdown","id":"43da86cb","metadata":{"id":"43da86cb"},"source":["#TIME-SERIES FORECASTING (TSF)"]},{"cell_type":"markdown","id":"a6b0e3d7","metadata":{"id":"a6b0e3d7"},"source":["## Importing Libraries"]},{"cell_type":"code","execution_count":null,"id":"3247e4ca","metadata":{"id":"3247e4ca"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","%matplotlib inline\n","# sns.set()"]},{"cell_type":"code","execution_count":null,"id":"96e22325","metadata":{"id":"96e22325"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"0d39699a","metadata":{"id":"0d39699a"},"source":["=========="]},{"cell_type":"markdown","id":"f8c2ed4b","metadata":{"id":"f8c2ed4b"},"source":["## Miles Travelled | Time Series Forecasting"]},{"cell_type":"markdown","id":"65d6f76f","metadata":{"id":"65d6f76f"},"source":["Dataset Source:\n","- https://www.kaggle.com/datasets/bulentsiyah/for-simple-exercises-time-series-forecasting"]},{"cell_type":"code","execution_count":null,"id":"57702ea2","metadata":{"id":"57702ea2"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"a2b9ccf5","metadata":{"id":"a2b9ccf5"},"source":["## Importing & Inspecting Data"]},{"cell_type":"code","execution_count":null,"id":"fcf4c571","metadata":{"id":"fcf4c571"},"outputs":[],"source":["miles = pd.read_csv('datasets/miles_traveled.csv')\n","miles.head()"]},{"cell_type":"code","execution_count":null,"id":"9fa39d96","metadata":{"id":"9fa39d96"},"outputs":[],"source":["miles.info()"]},{"cell_type":"code","execution_count":null,"id":"191855a5","metadata":{"id":"191855a5"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"d4fce451","metadata":{"id":"d4fce451"},"source":["## Exploring Data"]},{"cell_type":"code","execution_count":null,"id":"0e60b99e","metadata":{"id":"0e60b99e"},"outputs":[],"source":["miles.plot(figsize=(20,10))"]},{"cell_type":"code","execution_count":null,"id":"a8a7a3b5","metadata":{"id":"a8a7a3b5"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"dc5f59f4","metadata":{"id":"dc5f59f4"},"source":["## Pre-processing Data"]},{"cell_type":"markdown","id":"404fda8e","metadata":{"id":"404fda8e"},"source":["##### Manipulating Time-series Data"]},{"cell_type":"code","execution_count":null,"id":"d834ed00","metadata":{"id":"d834ed00"},"outputs":[],"source":["miles.set_index('DATE', inplace=True)"]},{"cell_type":"code","execution_count":null,"id":"e60ae682","metadata":{"id":"e60ae682"},"outputs":[],"source":["miles.index.freq = 'MS'"]},{"cell_type":"code","execution_count":null,"id":"fb5e14de","metadata":{"id":"fb5e14de"},"outputs":[],"source":["miles.rename(columns={'TRFVOLUSM227NFWA':'MILES'}, inplace=True)"]},{"cell_type":"code","execution_count":null,"id":"610243af","metadata":{"id":"610243af"},"outputs":[],"source":["miles"]},{"cell_type":"code","execution_count":null,"id":"297e7330","metadata":{"id":"297e7330"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"431f5838","metadata":{"id":"431f5838"},"source":["##### Splitting Data"]},{"cell_type":"code","execution_count":null,"id":"4f0d69ad","metadata":{"id":"4f0d69ad"},"outputs":[],"source":["miles.shape"]},{"cell_type":"code","execution_count":null,"id":"19f75b2d","metadata":{"id":"19f75b2d"},"outputs":[],"source":["train = miles.iloc[:len(miles)-12]\n","train"]},{"cell_type":"code","execution_count":null,"id":"768f82e0","metadata":{"id":"768f82e0"},"outputs":[],"source":["test = miles.iloc[len(miles)-12:]\n","test"]},{"cell_type":"code","execution_count":null,"id":"f3b2c1e4","metadata":{"id":"f3b2c1e4"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"9d244122","metadata":{"id":"9d244122"},"source":["##### Scaling Data"]},{"cell_type":"code","execution_count":null,"id":"7bf7ee65","metadata":{"id":"7bf7ee65"},"outputs":[],"source":["from sklearn.preprocessing import MinMaxScaler"]},{"cell_type":"code","execution_count":null,"id":"684b42e0","metadata":{"id":"684b42e0"},"outputs":[],"source":["sc = MinMaxScaler()"]},{"cell_type":"code","execution_count":null,"id":"cc84b17b","metadata":{"id":"cc84b17b"},"outputs":[],"source":["df_train = sc.fit_transform(train)\n","df_train"]},{"cell_type":"code","execution_count":null,"id":"cbb4d416","metadata":{"id":"cbb4d416"},"outputs":[],"source":["df_test = sc.fit_transform(test)\n","df_test"]},{"cell_type":"code","execution_count":null,"id":"1c2f8d50","metadata":{"id":"1c2f8d50"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"48afec08","metadata":{"id":"48afec08"},"source":["##### Time-series Generator"]},{"cell_type":"code","execution_count":null,"id":"ee27e3c6","metadata":{"id":"ee27e3c6"},"outputs":[],"source":["n_input = 12\n","n_features = 1"]},{"cell_type":"code","execution_count":null,"id":"bf24922f","metadata":{"id":"bf24922f"},"outputs":[],"source":["from keras.preprocessing.sequence import TimeseriesGenerator"]},{"cell_type":"code","execution_count":null,"id":"627b0a2d","metadata":{"id":"627b0a2d"},"outputs":[],"source":["generator = TimeseriesGenerator(df_train, df_train, length=n_input, batch_size=1)"]},{"cell_type":"code","execution_count":null,"id":"2bf5c1dc","metadata":{"id":"2bf5c1dc"},"outputs":[],"source":["len(generator)"]},{"cell_type":"code","execution_count":null,"id":"188a077b","metadata":{"id":"188a077b"},"outputs":[],"source":["len(df_train)"]},{"cell_type":"code","execution_count":null,"id":"08f719ef","metadata":{"id":"08f719ef"},"outputs":[],"source":["df_train[:13]"]},{"cell_type":"code","execution_count":null,"id":"a09d3f8a","metadata":{"id":"a09d3f8a"},"outputs":[],"source":["generator[0]"]},{"cell_type":"code","execution_count":null,"id":"46f0ca4e","metadata":{"id":"46f0ca4e"},"outputs":[],"source":["generator[0][0].shape"]},{"cell_type":"code","execution_count":null,"id":"1855bf71","metadata":{"id":"1855bf71"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"4eca46d4","metadata":{"id":"4eca46d4"},"source":["## Model Training & Building"]},{"cell_type":"code","execution_count":null,"id":"2f16b441","metadata":{"id":"2f16b441"},"outputs":[],"source":["from tensorflow.keras.layers import Dense, LSTM\n","from tensorflow.keras.models import Sequential"]},{"cell_type":"code","execution_count":null,"id":"c7fa87b6","metadata":{"id":"c7fa87b6"},"outputs":[],"source":["model = Sequential(\n","    [(LSTM(50, activation='relu', input_shape=(n_input, n_features))),\n","     (Dense(1))])"]},{"cell_type":"code","execution_count":null,"id":"39e4046b","metadata":{"id":"39e4046b"},"outputs":[],"source":["model.summary()"]},{"cell_type":"code","execution_count":null,"id":"443540de","metadata":{"id":"443540de"},"outputs":[],"source":["model.compile(optimizer='adam', loss='mse')"]},{"cell_type":"code","execution_count":null,"id":"48b0f48f","metadata":{"id":"48b0f48f"},"outputs":[],"source":["model.fit_generator(generator,epochs=30)"]},{"cell_type":"code","execution_count":null,"id":"dda3594e","metadata":{"id":"dda3594e"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"a0111e0c","metadata":{"id":"a0111e0c"},"source":["## Model Evaluation"]},{"cell_type":"code","execution_count":null,"id":"81ccad56","metadata":{"id":"81ccad56"},"outputs":[],"source":["# plot the history of the loss that occured during training\n","loss_per_epoch = model.history.history['loss']\n","plt.plot(range(len(loss_per_epoch)),loss_per_epoch)"]},{"cell_type":"code","execution_count":null,"id":"ca32e4ba","metadata":{"id":"ca32e4ba"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"c6be9e18","metadata":{"id":"c6be9e18"},"source":["##### Model Prediction"]},{"cell_type":"code","execution_count":null,"id":"be0afe67","metadata":{"id":"be0afe67"},"outputs":[],"source":["df_train[-n_input:]"]},{"cell_type":"code","execution_count":null,"id":"e1335fd1","metadata":{"id":"e1335fd1"},"outputs":[],"source":["first_eval_batch = df_train[-n_input:]"]},{"cell_type":"code","execution_count":null,"id":"88915dba","metadata":{"id":"88915dba"},"outputs":[],"source":["first_eval_batch = first_eval_batch.reshape((1, n_input, n_features))"]},{"cell_type":"code","execution_count":null,"id":"2d4337a3","metadata":{"id":"2d4337a3"},"outputs":[],"source":["model.predict(first_eval_batch)"]},{"cell_type":"code","execution_count":null,"id":"aea3c923","metadata":{"id":"aea3c923"},"outputs":[],"source":[]},{"cell_type":"markdown","id":"aaa4b1e8","metadata":{"id":"aaa4b1e8"},"source":["## Model Deployment"]},{"cell_type":"code","execution_count":null,"id":"79365b01","metadata":{"id":"79365b01"},"outputs":[],"source":["model.save('coolmodel.h5')"]},{"cell_type":"code","execution_count":null,"id":"666f90f7","metadata":{"id":"666f90f7"},"outputs":[],"source":["from keras.models import load_model"]},{"cell_type":"code","execution_count":null,"id":"7e9cc19e","metadata":{"id":"7e9cc19e"},"outputs":[],"source":["loaded = load_model('coolmodel.h5')"]},{"cell_type":"code","execution_count":null,"id":"8a42655f","metadata":{"id":"8a42655f"},"outputs":[],"source":["loaded.predict(first_eval_batch)"]},{"cell_type":"code","execution_count":null,"id":"9e1c79c9","metadata":{"id":"9e1c79c9"},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":5}